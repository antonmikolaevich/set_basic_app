<section>
  <h2 class="mb-4">Search Bookings</h2>

  <form id="searchBookingForm" class="row g-3">
    <div class="col-md-3">
      <label class="form-label">Booking ID</label>
      <input id="searchBookingId" class="form-control" placeholder="Enter Booking ID">
    </div>

    <div class="col-12">
      <button class="btn btn-primary" type="submit">Search</button>
    </div>
  </form>

  <div id="searchBookingResult" class="mt-3"></div>
</section>

<hr>

<section class="row mb-3">
  <div class="col">
    <h3>All Bookings</h3>
  </div>
  <div class="col text-end">
    <button class="btn btn-success" id="openCreateBookingBtn">
      Create New Booking
    </button>
  </div>
</section>

<div class="row mt-4">
  <% if (bookings && bookings.length > 0) { %>
    <% bookings.forEach(booking => { %>
      <div class="col-md-4 mb-4">
        <div class="card shadow-sm">

          <div class="card-body">
            <p><strong>Booking ID:</strong> <%= booking._id %></p>
            <p><strong>Product:</strong> <%= booking.product_id?.name %></p>
            <p><strong>User:</strong> <%= booking.user_id?.name %></p>
            <p><strong>Delivery Address:</strong> <%= booking.delivery_address %></p>
            <p><strong>Delivery Time:</strong> 
              <%= new Date(booking.delivery_time).toLocaleString() %>
            </p>
            <p><strong>Status:</strong> <%= booking.status_id?.name %></p>
            <p><strong>Quantity:</strong> <%= booking.quantity %></p>
          </div>

          <div class="card-footer d-flex justify-content-between">
            <button 
              type="button" 
              class="btn btn-sm btn-primary edit-booking-btn"
              data-id="<%= booking._id %>"
              data-user_id="<%= booking.user_id?._id %>"
              data-product_id="<%= booking.product_id?._id %>"
              data-delivery_address="<%- booking.delivery_address %>"
              data-delivery_date="<%= booking.delivery_date ? new Date(booking.delivery_date).toISOString().slice(0,10) : '' %>"
              data-delivery_time="<%= booking.delivery_time ? new Date(booking.delivery_time).toTimeString().slice(0,5) : '' %>"
              data-status_id="<%= booking.status_id?._id %>"
              data-quantity="<%= booking.quantity %>"
            >
              Edit
            </button>

            <button 
              class="btn btn-sm btn-danger delete-booking-btn" 
              data-id="<%= booking._id %>"
            >
              Delete
            </button>
          </div>

        </div>
      </div>
    <% }) %>
  <% } else { %>
    <p>No bookings found.</p>
  <% } %>
</div>

<!-- PAGINATION -->
<% if (totalPages && totalPages > 1) { %>
  <nav aria-label="Bookings pagination" class="mt-4">
    <ul class="pagination justify-content-end">

      <!-- Previous -->
      <% if (currentPage > 1) { %>
        <li class="page-item">
          <a class="page-link" href="/bookings?page=<%= currentPage - 1 %>">Previous</a>
        </li>
      <% } else { %>
        <li class="page-item disabled">
          <span class="page-link">Previous</span>
        </li>
      <% } %>

      <!-- Page numbers -->
      <% for (let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= i === currentPage ? 'active' : '' %>">
          <a class="page-link" href="/bookings?page=<%= i %>"><%= i %></a>
        </li>
      <% } %>

      <!-- Next -->
      <% if (currentPage < totalPages) { %>
        <li class="page-item">
          <a class="page-link" href="/bookings?page=<%= currentPage + 1 %>">Next</a>
        </li>
      <% } else { %>
        <li class="page-item disabled">
          <span class="page-link">Next</span>
        </li>
      <% } %>

    </ul>
  </nav>
<% } %>
